# –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Ä–µ—à–µ–Ω–∏—è

## üéØ –í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–µ—à–µ–Ω–∏–π (–æ—Ç –ø—Ä–æ—Å—Ç–æ–≥–æ –∫ —Å–ª–æ–∂–Ω–æ–º—É)

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π Selenium –æ–±—Ä–∞–∑ (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø) ‚≠ê

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ì–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ —Å VNC —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚úÖ –ú–µ–Ω—å—à–µ –∫–æ–¥–∞ –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏
- ‚úÖ –ë—ã—Å—Ç—Ä–µ–µ —Å–±–æ—Ä–∫–∞ (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à)
- ‚úÖ –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ë–æ–ª—å—à–∏–π —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞ (~1.5GB)
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–±—ã—Ç–æ—á–Ω—ã–º, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–µ–Ω Selenium

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ Dockerfile.browser.simple
docker build -t maskbrowser/browser:latest -f Dockerfile.browser.simple .
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å browserless/chrome (–ê–õ–¨–¢–ï–†–ù–ê–¢–ò–í–ê)

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –°–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –±—Ä–∞—É–∑–µ—Ä–Ω–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –í—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ VNC
- ‚úÖ –ú–µ–Ω—å—à–µ —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞
- ‚úÖ API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–æ–º

**–ù–µ–¥–æ—Å—Ç–∞—Ç–∫–∏:**
- ‚ö†Ô∏è –ú–æ–∂–µ—Ç —Ç—Ä–µ–±–æ–≤–∞—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è API

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```dockerfile
FROM browserless/chrome:latest
# –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ websockify + noVNC
```

---

### –í–∞—Ä–∏–∞–Ω—Ç 3: –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π Dockerfile

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
1. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `supervisord` –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
2. –£–ø—Ä–æ—Å—Ç–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É noVNC (–æ–¥–∏–Ω RUN)
3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å multi-stage build –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞

---

## üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –¥–ª—è VNC
```bash
# –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è
VNC_PASSWORD=$(openssl rand -base64 12)
x11vnc -storepasswd "$VNC_PASSWORD" /tmp/vncpass
x11vnc -display :99 -rfbauth /tmp/vncpass -rfbport 5900 ...
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å reverse proxy (nginx) –¥–ª—è VNC
- –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é –Ω–∞ —É—Ä–æ–≤–Ω–µ nginx
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å HTTPS/WSS
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ IP

### 3. –ò–∑–æ–ª–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Ç—å
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—É—é Docker —Å–µ—Ç—å –¥–ª—è –ø—Ä–æ—Ñ–∏–ª–µ–π
- –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏

---

## ‚ö° –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### 1. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ Docker —Å–ª–æ–µ–≤
```dockerfile
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ª–æ–µ
RUN apt-get update && apt-get install -y \
    python3 python3-pip \
    && rm -rf /var/lib/apt/lists/*

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å noVNC –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–º —Å–ª–æ–µ
RUN mkdir -p /usr/share/novnc && \
    cd /usr/share/novnc && \
    wget -qO- https://github.com/novnc/noVNC/archive/refs/tags/v1.4.0.tar.gz | \
    tar -xz --strip-components=1
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å multi-stage build
```dockerfile
FROM ubuntu:22.04 AS builder
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

FROM ubuntu:22.04 AS runtime
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤
```

### 3. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å React
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å React.memo –¥–ª—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å useMemo/useCallback –≥–¥–µ –Ω—É–∂–Ω–æ
- –†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ React Query –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º

---

## üêõ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ React –æ—à–∏–±–æ–∫

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å React Query (–†–ï–ö–û–ú–ï–ù–î–£–ï–¢–°–Ø)
```bash
npm install @tanstack/react-query
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- ‚úÖ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ unmounted –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- ‚úÖ Retry –ª–æ–≥–∏–∫–∞

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–ø—Ä–æ—Å—Ç–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–æ–¥
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useRef` –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–±—Ä–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π useEffect
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `useCallback` –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–µ—à–µ–Ω–∏–π

| –†–µ—à–µ–Ω–∏–µ | –°–ª–æ–∂–Ω–æ—Å—Ç—å | –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è |
|---------|-----------|--------------|-------------------|--------------|
| Selenium –æ–±—Ä–∞–∑ | ‚≠ê –ù–∏–∑–∫–∞—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚úÖ **–õ—É—á—à–∏–π –≤—ã–±–æ—Ä** |
| Browserless | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚úÖ –•–æ—Ä–æ—à–∞—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞ |
| –¢–µ–∫—É—â–∏–π (—É–ª—É—á—à–µ–Ω–Ω—ã–π) | ‚≠ê‚≠ê‚≠ê –í—ã—Å–æ–∫–∞—è | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | ‚≠ê‚≠ê –°—Ä–µ–¥–Ω—è—è | ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –ø–æ–¥–¥–µ—Ä–∂–∫–∏ |

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Selenium –æ–±—Ä–∞–∑–æ–º

1. **–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Dockerfile.browser.simple`**
2. **–ü–µ—Ä–µ—Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑:**
   ```bash
   docker build -t maskbrowser/browser:latest -f infra/Dockerfile.browser.simple infra/
   ```
3. **–ì–æ—Ç–æ–≤–æ!** VNC —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –Ω—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ websockify

---

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å supervisor** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
2. **–î–æ–±–∞–≤–∏—Ç—å health checks** –¥–ª—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
3. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Docker Compose** –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
4. **–î–æ–±–∞–≤–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** (Prometheus/Grafana)
5. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CDN** –¥–ª—è noVNC —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–∞–π–ª–æ–≤

