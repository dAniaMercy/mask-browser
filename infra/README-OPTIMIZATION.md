# üöÄ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–æ–µ —Ä–µ—à–µ–Ω–∏–µ: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–π Selenium –æ–±—Ä–∞–∑

### –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
1. ‚úÖ **–ì–æ—Ç–æ–≤—ã–π VNC** - –Ω–µ –Ω—É–∂–Ω–æ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å x11vnc
2. ‚úÖ **–ú–µ–Ω—å—à–µ –∫–æ–¥–∞** - —Ç–æ–ª—å–∫–æ websockify + noVNC
3. ‚úÖ **–ë—ã—Å—Ç—Ä–µ–µ —Å–±–æ—Ä–∫–∞** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –∫—ç—à Docker Hub
4. ‚úÖ **–ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω—ã–π** - –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ
5. ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏–∑ –∫–æ—Ä–æ–±–∫–∏

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```bash
# 1. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å –æ–±—Ä–∞–∑ —Å —É–ø—Ä–æ—â–µ–Ω–Ω—ã–º Dockerfile
cd /opt/mask-browser/infra
docker build -t maskbrowser/browser:latest -f Dockerfile.browser.simple .

# 2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
docker-compose up -d --build web
```

### –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å:
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `selenium/standalone-chrome:latest` –∫–∞–∫ –±–∞–∑–æ–≤—ã–π –æ–±—Ä–∞–∑
- VNC —É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –ø–æ—Ä—Ç—É 5900
- –ù—É–∂–µ–Ω —Ç–æ–ª—å–∫–æ websockify –¥–ª—è noVNC
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –∑–∞–ø—É—Å–∫–∞ (`start-websockify.sh`)

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: Browserless Chrome

–ï—Å–ª–∏ –Ω—É–∂–µ–Ω –±–æ–ª–µ–µ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç:

```dockerfile
FROM browserless/chrome:latest
# –î–æ–±–∞–≤–∏—Ç—å —Ç–æ–ª—å–∫–æ websockify + noVNC
```

---

## –£–ø—Ä–æ—â–µ–Ω–∏–µ React –∫–æ–¥–∞

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å React Query (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```bash
npm install @tanstack/react-query
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å unmounted –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏
- –í—Å—Ç—Ä–æ–µ–Ω–Ω–æ–µ –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ retry

### –í–∞—Ä–∏–∞–Ω—Ç 2: –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∫–æ–¥ (—Ç–µ–∫—É—â–∏–π)

–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `page.simple.tsx` –∫–∞–∫ –ø—Ä–∏–º–µ—Ä —É–ø—Ä–æ—â–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏.

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### 1. –î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å –¥–ª—è VNC

```bash
# –í start-browser.sh
VNC_PASSWORD=$(openssl rand -base64 12)
x11vnc -storepasswd "$VNC_PASSWORD" /tmp/vncpass
x11vnc -rfbauth /tmp/vncpass ...
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å nginx reverse proxy

```nginx
location /vnc/ {
    proxy_pass http://localhost:6080/;
    proxy_http_version 1.1;
    proxy_set_header Upgrade $http_upgrade;
    proxy_set_header Connection "upgrade";
    # –î–æ–±–∞–≤–∏—Ç—å –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—é
}
```

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

1. **Multi-stage build** - —É–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –æ–±—Ä–∞–∑–∞
2. **–ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–ª–æ–µ–≤** - –±—ã—Å—Ç—Ä–µ–µ –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∞
3. **CDN –¥–ª—è noVNC** - –±—ã—Å—Ç—Ä–µ–µ –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏–∫–∏

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤ –æ–±—Ä–∞–∑–æ–≤

- `selenium/standalone-chrome`: ~1.5GB
- `browserless/chrome`: ~800MB
- –¢–µ–∫—É—â–∏–π –∫–∞—Å—Ç–æ–º–Ω—ã–π: ~1.2GB

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `Dockerfile.browser.simple`** - —ç—Ç–æ —Å–∞–º–æ–µ –ø—Ä–æ—Å—Ç–æ–µ –∏ –Ω–∞–¥–µ–∂–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.

